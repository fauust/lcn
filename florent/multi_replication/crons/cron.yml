---
############
### CRON ###
############
---
# kind: CronJob
# metadata:
#   name: dump
# spec:
#   schedule: "*/1 * * * *"
#   jobTemplate:
#     spec:
#       template:
#         spec:
#           containers:
#             - name: dump
#               image: mariadb:10.6.18
#               command: ["/bin/bash", "-c"]
#               args:
#                 - |
#                   DB_NAME=mydb
#                   PRIMARY=sql-01
#                   REPLICA=sql-svg-0
#                   TIMESTAMP=$(TZ='Europe/Paris' date +%Y%m%d_%H%M%S)
#                   BACKUP_FOLDER=/db_backup/$DB_NAME__$TIMESTAMP
#                   kubectl exec -it $REPLICA -- /bin/bash
#                   mkdir -v -p $BACKUP_FOLDER
#                   mariadb-dump -v -h $PRIMARY -u admin -proot $DB_NAME > $BACKUP_FOLDER/mydb.sql
#               volumeMounts:
#                 - name: dump
#                   mountPath: /docker-entrypoint-initdb.d
#           restartPolicy: OnFailure
#           volumes:
#             - name: dump
#               persistentVolumeClaim:
#                 claimName: pvc
# apiVersion: batch/v1
